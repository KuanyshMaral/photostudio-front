# PhotoStudio Frontend

Веб‑клиент для платформы бронирования фотостудий. Приложение объединяет каталог студий, бронирования, отзывы, личные кабинеты пользователей/владельцев, а также административные инструменты управления платформой.

## Возможности

- **Аутентификация и профили**: регистрация, вход, профиль пользователя, ролевой доступ.  
- **Каталог студий**: список студий, детальная карточка студии.  
- **Бронирования**: форма бронирования, календарь доступности, список моих бронирований.  
- **Отзывы**: просмотр и написание отзывов.  
- **Админ‑панель**: аналитика, модерация отзывов, управление рекламой и VIP‑статусами студий.  
- **Кабинет владельца/менеджера**: управление бронированиями и клиентами.  
- **Чат**: переписка между участниками.  

## Технологии

- **React 19 + TypeScript** — UI и типизация.
- **Vite** — сборка и дев‑сервер.
- **React Router** — маршрутизация.
- **React Query** — запросы и кэширование.
- **Tailwind CSS** — стили.
- **Playwright** — e2e‑тесты.

## Быстрый старт

### 1) Установка зависимостей

```bash
npm install
```

### 2) Переменные окружения

Создайте файл `.env` (или используйте `.env.local`) и задайте адрес бэкенда:

```bash
VITE_API_URL=http://localhost:8080/api/v1
```

Если переменная не задана, используется значение по умолчанию `http://localhost:8080/api/v1`.

### 3) Запуск приложения

```bash
npm run dev
```

Откройте в браузере: `http://localhost:5173`.

## Скрипты

- `npm run dev` — запуск в режиме разработки.
- `npm run build` — сборка проекта.
- `npm run build:docker` — сборка для Docker (без TypeScript build step).
- `npm run preview` — локальный предпросмотр сборки.
- `npm run lint` — проверка ESLint.
- `npm run test` — e2e‑тесты Playwright.
- `npm run test:ui` — Playwright UI‑режим.

## Архитектура проекта

```
src/
  api/            # типизированные запросы и сервисы API
  assets/         # изображения и статические ресурсы
  components/     # переиспользуемые компоненты (layout, ProtectedRoute и т.д.)
  config/         # конфигурация приложения
  context/        # контексты React
  data/           # локальные мок‑данные
  features/       # фичи (auth, booking, catalog, admin, owner и т.д.)
  hooks/          # кастомные хуки
  lib/            # библиотечные утилиты (axios‑клиент)
  services/       # бизнес‑сервисы
  types/          # TypeScript типы
  utils/          # вспомогательные функции
  App.tsx         # маршрутизация и основные страницы
  main.tsx        # входная точка
```

## Роли и доступ

Маршруты защищены компонентом `ProtectedRoute`. В зависимости от роли пользователю доступны разные разделы:

- **user** — каталог, бронирования, отзывы, профиль.
- **studio_owner** — панель владельца/менеджера студии.
- **admin** — административная панель и аналитика.

## Требования

- Node.js **18+** (рекомендуется LTS).
- npm **9+**.

## Развертывание

1. Соберите проект:
   ```bash
   npm run build
   ```
2. Разверните содержимое папки `dist/` на любом статическом хостинге (NGINX, S3 и т.д.).
3. Убедитесь, что переменная `VITE_API_URL` указывает на доступный бэкенд.

## Полезно знать

- При изменении API‑адреса требуется пересборка фронтенда (Vite подставляет переменные на этапе сборки).
- Проверяйте доступность бэкенда перед запуском e2e‑тестов.

## Примеры API

Ниже приведены примеры запросов к бэкенду. Для выполнения запросов используйте базовый URL из `VITE_API_URL`.

### Получить список студий

```bash
curl -X GET "$VITE_API_URL/studios"
```

**Пример ответа:**

```json
{
  "items": [
    {
      "id": "studio_123",
      "name": "White Loft",
      "city": "Almaty",
      "rating": 4.8
    }
  ],
  "total": 1
}
```

### Создать бронирование

```bash
curl -X POST "$VITE_API_URL/bookings" \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer <ACCESS_TOKEN>" \
  -d '{
    "studioId": "studio_123",
    "roomId": "room_456",
    "startAt": "2025-02-10T10:00:00Z",
    "endAt": "2025-02-10T12:00:00Z",
    "contactName": "Иван Петров",
    "contactPhone": "+7 777 000 00 00"
  }'
```

**Пример ответа:**

```json
{
  "id": "booking_789",
  "status": "pending",
  "totalPrice": 25000,
  "currency": "KZT"
}
```
 
> Примечание: конкретные поля могут отличаться в зависимости от версии бэкенда. Уточняйте контракт в серверной документации.

## Как работает аутентификация

1. Пользователь регистрируется/входит через формы в разделе авторизации.
2. Токен доступа сохраняется на клиенте и передается в `Authorization` заголовке (`Bearer ...`) при защищенных запросах.
3. Компонент `ProtectedRoute` проверяет роль и состояние авторизации, чтобы открыть доступ к нужным разделам.

---

Если нужно дополнить README или добавить примеры API — создайте issue/задачу, и мы обновим документацию.
